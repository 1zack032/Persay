<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Channel - Menza</title>
    
    <!-- Theme initialization -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('menza-theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            }
        })();
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/static/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/static/icons/icon-192.svg">
    <link rel="stylesheet" href="/static/css/channel_create.css">
</head>
<body>
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <a href="/" class="nav-logo">
            <span class="nav-logo-text">Menza</span>
        </a>
        <div class="nav-tabs">
            <a href="/chat" class="nav-tab">Messages</a>
            <a href="/channels" class="nav-tab active">Channels</a>
            <a href="/settings" class="nav-tab">Settings</a>
            <a href="/logout" class="nav-tab">Sign Out</a>
        </div>
    </nav>

    <div class="main-container">
        <!-- Sidebar Navigation -->
        <aside class="create-sidebar">
            <ul class="create-nav">
                <li class="create-nav-item active" onclick="switchSection('basic')">
                    <span class="icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                    </span>
                    Basic Info
                </li>
                <li class="create-nav-item" onclick="switchSection('branding')">
                    <span class="icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="13.5" cy="6.5" r="2.5"/>
                            <circle cx="17.5" cy="10.5" r="2.5"/>
                            <circle cx="8.5" cy="7.5" r="2.5"/>
                            <circle cx="6.5" cy="12.5" r="2.5"/>
                            <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.563-2.512 5.563-5.563C22 6.5 17.5 2 12 2z"/>
                        </svg>
                    </span>
                    Branding
                </li>
                <li class="create-nav-item" onclick="switchSection('visibility')">
                    <span class="icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                    </span>
                    Visibility
                </li>
                <li class="create-nav-item" onclick="switchSection('members')">
                    <span class="icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                    </span>
                    Members
                </li>
                <li class="create-nav-item" onclick="switchSection('preview')">
                    <span class="icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <polyline points="21 15 16 10 5 21"/>
                        </svg>
                    </span>
                    Preview
                </li>
            </ul>
        </aside>

        <!-- Content Area -->
        <main class="create-content">
            <form method="POST" id="createForm">
                {% if error %}
                <div class="error-message">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="12"/>
                        <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    {{ error }}
                </div>
                {% endif %}

                <!-- Basic Info Section -->
                <div class="create-section active" id="section-basic">
                    <div class="create-header">
                        <div>
                            <h1>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                </svg>
                                Basic Information
                            </h1>
                            <p>Set up your channel name and description</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                            </svg>
                            Channel Details
                        </div>

                        <div class="form-group">
                            <label for="name">Channel Name <span style="color: var(--error);">*</span></label>
                            <input type="text" id="name" name="name" placeholder="My Awesome Channel" required maxlength="50">
                            <div class="input-hint">Choose a unique name for your channel</div>
                        </div>

                        <div class="form-group">
                            <label for="description">Description <span class="label-hint">(optional)</span></label>
                            <textarea id="description" name="description" placeholder="What's your channel about?" maxlength="500"></textarea>
                            <div class="input-hint">Help others understand what your channel is about</div>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button type="button" class="btn btn-primary" onclick="switchSection('branding')">
                            Continue to Branding
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18l6-6-6-6"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Branding Section -->
                <div class="create-section" id="section-branding">
                    <div class="create-header">
                        <div>
                            <h1>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="13.5" cy="6.5" r="2.5"/>
                                    <circle cx="17.5" cy="10.5" r="2.5"/>
                                    <circle cx="8.5" cy="7.5" r="2.5"/>
                                    <circle cx="6.5" cy="12.5" r="2.5"/>
                                    <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.563-2.512 5.563-5.563C22 6.5 17.5 2 12 2z"/>
                                </svg>
                                Branding
                            </h1>
                            <p>Customize how your channel looks</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                                <line x1="9" y1="9" x2="9.01" y2="9"/>
                                <line x1="15" y1="9" x2="15.01" y2="9"/>
                            </svg>
                            Channel Icon
                        </div>

                        <div class="icon-type-tabs">
                            <button type="button" class="icon-type-tab active" data-type="emoji">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                                    <line x1="9" y1="9" x2="9.01" y2="9"/>
                                    <line x1="15" y1="9" x2="15.01" y2="9"/>
                                </svg>
                                Emoji
                            </button>
                            <button type="button" class="icon-type-tab" data-type="upload">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                                Upload Image
                            </button>
                        </div>

                        <!-- Emoji Selection -->
                        <div class="icon-content active" id="emojiContent">
                            <div class="form-group">
                                <label>Select an emoji for your channel</label>
                                <div class="emoji-picker" id="emojiPicker">
                                    {% for emoji in ['üì¢', 'üéØ', 'üí°', 'üöÄ', 'üé®', 'üìö', 'üéÆ', 'üéµ', 'üí¨', '‚≠ê', 'üî•', 'üíé', 'üåü', 'üì£', 'üé§', 'üì∞'] %}
                                    <label class="emoji-option {% if loop.first %}selected{% endif %}">
                                        <input type="radio" name="avatar_emoji" value="{{ emoji }}" {% if loop.first %}checked{% endif %}>
                                        {{ emoji }}
                                    </label>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- Image Upload -->
                        <div class="icon-content" id="uploadContent">
                            <div class="form-group">
                                <label>Upload a custom image</label>
                                <div class="upload-area" id="uploadArea">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                        <polyline points="17 8 12 3 7 8"/>
                                        <line x1="12" y1="3" x2="12" y2="15"/>
                                    </svg>
                                    <h4>Click to upload or drag and drop</h4>
                                    <p>PNG, JPG, GIF up to 5MB (Recommended: 256x256px)</p>
                                    <input type="file" id="channelImageInput" name="channel_image" accept="image/png,image/jpeg,image/gif,image/webp">
                                </div>
                                <div class="upload-preview" id="uploadPreview">
                                    <img src="" alt="Preview" class="upload-preview-image" id="previewImage">
                                    <div class="upload-preview-info">
                                        <div class="upload-preview-name" id="previewName">filename.png</div>
                                        <div class="upload-preview-size" id="previewSize">0 KB</div>
                                    </div>
                                    <button type="button" class="upload-preview-remove" id="removeImage">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="18" y1="6" x2="6" y2="18"/>
                                            <line x1="6" y1="6" x2="18" y2="18"/>
                                        </svg>
                                    </button>
                                </div>
                                <input type="hidden" name="avatar_type" id="avatarType" value="emoji">
                                <input type="hidden" name="avatar_image_data" id="avatarImageData" value="">
                            </div>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
                            </svg>
                            Accent Color
                        </div>

                        <div class="form-group">
                            <label>Choose your channel's theme color</label>
                            <div class="color-picker" id="colorPicker">
                                {% for color in ['#6366f1', '#8b5cf6', '#ec4899', '#ef4444', '#f59e0b', '#22c55e', '#06b6d4', '#3b82f6'] %}
                                <label class="color-option {% if loop.first %}selected{% endif %}" style="background: {{ color }};">
                                    <input type="radio" name="accent_color" value="{{ color }}" {% if loop.first %}checked{% endif %}>
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button type="button" class="btn" onclick="switchSection('basic')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 18l-6-6 6-6"/>
                            </svg>
                            Back
                        </button>
                        <button type="button" class="btn btn-primary" onclick="switchSection('visibility')">
                            Continue to Visibility
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18l6-6-6-6"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Visibility Section -->
                <div class="create-section" id="section-visibility">
                    <div class="create-header">
                        <div>
                            <h1>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                                Visibility Settings
                            </h1>
                            <p>Control who can find and access your channel</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/>
                            </svg>
                            Discoverability
                        </div>

                        <div class="toggle-row">
                            <div class="toggle-info">
                                <div class="toggle-title">Make channel discoverable</div>
                                <div class="toggle-desc">Allow others to find your channel in search results and discovery</div>
                            </div>
                            <label class="toggle-label">
                                <input type="checkbox" name="discoverable" id="discoverableToggle" checked>
                                <span class="toggle-switch"></span>
                            </label>
                        </div>

                        <div class="visibility-note" id="visibilityNote">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                            </svg>
                            <span>Your channel will appear in search results and the discovery section. High engagement channels get featured in trending.</span>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button type="button" class="btn" onclick="switchSection('branding')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 18l-6-6 6-6"/>
                            </svg>
                            Back
                        </button>
                        <button type="button" class="btn btn-primary" onclick="switchSection('members')">
                            Continue to Members
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18l6-6-6-6"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Members Section -->
                <div class="create-section" id="section-members">
                    <div class="create-header">
                        <div>
                            <h1>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="9" cy="7" r="4"/>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                </svg>
                                Invite Members
                            </h1>
                            <p>Add people to your channel with specific roles</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="8.5" cy="7" r="4"/>
                                <line x1="20" y1="8" x2="20" y2="14"/>
                                <line x1="23" y1="11" x2="17" y2="11"/>
                            </svg>
                            Add Members
                        </div>

                        <div class="members-list" id="membersList">
                            <!-- Members will be added here -->
                        </div>

                        <div class="add-member-row">
                            <input type="text" id="memberInput" placeholder="Enter username">
                            <select id="roleSelect" class="role-select">
                                <option value="viewer">Viewer</option>
                                <option value="mod">Moderator</option>
                                <option value="admin">Admin</option>
                            </select>
                            <button type="button" id="addMemberBtn" class="btn btn-sm">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                Add
                            </button>
                        </div>

                        <input type="hidden" name="invited_members" id="invitedMembersInput" value="[]">
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                                <line x1="12" y1="17" x2="12.01" y2="17"/>
                            </svg>
                            Role Permissions
                        </div>

                        <div class="roles-info">
                            <div class="role-info-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="2">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                                <div>
                                    <strong>Admin</strong>
                                    <p>Full access: manage settings, members, posts, and permissions</p>
                                </div>
                            </div>
                            <div class="role-info-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="var(--accent-secondary)" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                </svg>
                                <div>
                                    <strong>Moderator</strong>
                                    <p>Can post content and moderate comments, but cannot change settings</p>
                                </div>
                            </div>
                            <div class="role-info-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                                <div>
                                    <strong>Viewer</strong>
                                    <p>Read-only access to all channel content</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button type="button" class="btn" onclick="switchSection('visibility')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 18l-6-6 6-6"/>
                            </svg>
                            Back
                        </button>
                        <button type="button" class="btn btn-primary" onclick="switchSection('preview')">
                            Continue to Preview
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18l6-6-6-6"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="create-section" id="section-preview">
                    <div class="create-header">
                        <div>
                            <h1>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                                Preview & Create
                            </h1>
                            <p>Review your channel before creating it</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                            </svg>
                            Channel Preview
                        </div>

                        <div class="preview-card">
                            <div class="preview-avatar" id="previewAvatar" style="background: rgba(99, 102, 241, 0.15); color: #6366f1;">
                                üì¢
                            </div>
                            <div class="preview-info">
                                <h4 id="previewName">Your Channel</h4>
                                <p id="previewDesc">Channel description...</p>
                            </div>
                            <span class="preview-badge public" id="previewBadge">Public</span>
                        </div>
                    </div>

                    <div class="section-card">
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                            Summary
                        </div>

                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-muted);">Name</span>
                                <span id="summaryName">-</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-muted);">Visibility</span>
                                <span id="summaryVisibility">Public</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                                <span style="color: var(--text-muted);">Members</span>
                                <span id="summaryMembers">0 invited</span>
                            </div>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button type="button" class="btn" onclick="switchSection('members')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 18l-6-6 6-6"/>
                            </svg>
                            Back
                        </button>
                        <button type="submit" class="btn btn-primary" style="flex: 1;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                            Create Channel
                        </button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <script src="/static/js/channel_create.js"></script>
</body>
</html>
